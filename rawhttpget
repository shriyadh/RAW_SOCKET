#!/usr/bin/env python3
# TOKEN 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
# My password Benzene66


import ssl
import socket
import sys
from struct import *


# checksum functions needed for calculation checksum
def checksum(msg):
    s = 0

    # loop taking 2 characters at a time
    for i in range(0, len(msg), 2):
        w = ord(msg[i]) + (ord(msg[i + 1]) << 8)
        s = s + w

    s = (s >> 16) + (s & 0xffff);
    s = s + (s >> 16);

    # complement and mask to 4 byte short
    s = ~s & 0xffff

    return s


def parse_cmd_line():
    try:
        url = sys.argv[0]
    except:
        sys.exit("Please provide proper URL")


def downLoadFiles(url):
    file = ""
    # check if proper path is given, if not set default
    if url.endswith('/'):
        file = "index.html"
    else:
        # split to get file name
        file = url.split('/')[-1]

    # open file and read
    fOpen = open(file, 'wb+')

    # create socket
    create_socket()

def create_socket():

    # create tcp header and
    try:
        s = socket.socket(socket.AF_INET, socket.IPPROTO_RAW)
    except socket.error as msg:
        sys.exit("Connection cannot be made" + msg)

    return s


def main():
    # parse the cmd line to get the url download link
    url = parse_cmd_line()

    downLoadFiles(url)





if __name__ == "__main__":
    main()
