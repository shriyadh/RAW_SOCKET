#!/usr/bin/env python3

import sys
from TCP import TCP


def parse_cmd_line():
    """
    Parses command line arguments to retrieve file to be downloaded.
    :return: url for downloading file.
    """

    if len(sys.argv) > 2:
        sys.exit("Expected 2 inputs. Found more.")

    try:
        url = sys.argv[1]
    except:
        sys.exit("Please provide proper URL")

    return url


def start_download(url):
    """
    This method deals with linking the TCP - IP layers with the application layers.
    Drives the flow of the program -- establish handshake, send request and receive/write data to file.
    :param url: link to be downloaded
    """
    tcp_ip_socket = TCP()
    tcp_ip_socket.establish_handshake(url, 80)
    tcp_ip_socket.send_http_req()



def main():
    # parse the cmd line to get the url download link
    url = parse_cmd_line()
    # create the Application-TCP-IP layers and send request for download
    start_download(url)


if __name__ == "__main__":
    main()
